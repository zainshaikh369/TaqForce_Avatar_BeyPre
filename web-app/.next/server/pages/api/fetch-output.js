"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/fetch-output";
exports.ids = ["pages/api/fetch-output"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffetch-output&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffetch-output.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffetch-output&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffetch-output.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_fetch_output_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/fetch-output.js */ \"(api)/./pages/api/fetch-output.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fetch_output_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fetch_output_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/fetch-output\",\n        pathname: \"/api/fetch-output\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_fetch_output_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZldGNoLW91dHB1dCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZmV0Y2gtb3V0cHV0LmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmV5LWF2YXRhci13ZWJhcHAvP2VlOGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9mZXRjaC1vdXRwdXQuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9mZXRjaC1vdXRwdXRcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9mZXRjaC1vdXRwdXRcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffetch-output&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffetch-output.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/fetch-output.js":
/*!***********************************!*\
  !*** ./pages/api/fetch-output.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\nconst API_URL = \"https://api.bey.dev/v1\";\nfunction tryParseJSON(s) {\n    try {\n        return JSON.parse(s);\n    } catch (e) {\n        return null;\n    }\n}\nfunction extractJsonFromText(text) {\n    if (!text) return null;\n    // try markers / fences\n    const patterns = [\n        /OUTPUT_JSON_START\\s*(\\{[\\s\\S]*?\\})\\s*OUTPUT_JSON_END/,\n        /```json\\s*(\\{[\\s\\S]*?\\})\\s*```/,\n        /(\\{\\s*\"role\"[\\s\\S]*?\\})/\n    ];\n    for (const pat of patterns){\n        const m = text.match(pat);\n        if (m && m[1]) {\n            const cand = m[1].replace(/`/g, \"\").trim();\n            const parsed = tryParseJSON(cand);\n            if (parsed) return parsed;\n            // try to remove trailing commas quickly\n            const cleaned = cand.replace(/,\\s*}\\s*$/m, \"}\").replace(/,\\s*\\]\\s*$/m, \"]\");\n            const parsed2 = tryParseJSON(cleaned);\n            if (parsed2) return parsed2;\n        }\n    }\n    // fallback: find balanced {...} or [...] blocks\n    const opens = [\n        [\n            \"{\",\n            \"}\"\n        ],\n        [\n            \"[\",\n            \"]\"\n        ]\n    ];\n    for (const [open, close] of opens){\n        for(let i = 0; i < text.length; i++){\n            if (text[i] !== open) continue;\n            let depth = 0;\n            for(let j = i; j < text.length; j++){\n                if (text[j] === open) depth++;\n                else if (text[j] === close) depth--;\n                if (depth === 0) {\n                    const cand = text.slice(i, j + 1);\n                    const parsed = tryParseJSON(cand);\n                    if (parsed) return parsed;\n                    const cleaned = cand.replace(/,\\s*}\\s*$/m, \"}\").replace(/,\\s*\\]\\s*$/m, \"]\");\n                    const parsed2 = tryParseJSON(cleaned);\n                    if (parsed2) return parsed2;\n                    break;\n                }\n            }\n        }\n    }\n    return null;\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") return res.status(405).json({\n        error: \"Method not allowed\"\n    });\n    const apiKey = process.env.BEY_API_KEY;\n    if (!apiKey) return res.status(500).json({\n        error: \"Missing BEY_API_KEY on server\"\n    });\n    const { agentId } = req.body || {};\n    if (!agentId) return res.status(400).json({\n        error: \"agentId required in body\"\n    });\n    try {\n        const callsResp = await fetch(`${API_URL}/calls`, {\n            headers: {\n                \"x-api-key\": apiKey\n            }\n        });\n        if (!callsResp.ok) {\n            const body = await callsResp.text();\n            return res.status(502).json({\n                error: `Failed fetching calls: ${callsResp.status}`,\n                detail: body\n            });\n        }\n        const callsJson = await callsResp.json();\n        const calls = callsJson.data || [];\n        // find latest ended call for this agent\n        const endedCalls = calls.filter((c)=>c.agent_id === agentId && c.ended_at).sort((a, b)=>new Date(b.ended_at) - new Date(a.ended_at));\n        if (endedCalls.length === 0) return res.status(404).json({\n            error: \"No ended calls found for agent\"\n        });\n        const call = endedCalls[0];\n        const messagesResp = await fetch(`${API_URL}/calls/${call.id}/messages`, {\n            headers: {\n                \"x-api-key\": apiKey\n            }\n        });\n        if (!messagesResp.ok) {\n            const body = await messagesResp.text();\n            return res.status(502).json({\n                error: `Failed fetching messages: ${messagesResp.status}`,\n                detail: body\n            });\n        }\n        const messages = await messagesResp.json();\n        // prefer assistant messages in reverse\n        let result = null;\n        for(let i = messages.length - 1; i >= 0; i--){\n            const msg = messages[i];\n            const sender = (msg.sender || \"\").toLowerCase();\n            if ([\n                \"assistant\",\n                \"ai\",\n                \"bot\"\n            ].includes(sender)) {\n                const parsed = extractJsonFromText(msg.message || \"\");\n                if (parsed) {\n                    result = {\n                        parsed,\n                        from: msg\n                    };\n                    break;\n                }\n            }\n        }\n        if (!result) {\n            const full = messages.map((m)=>m.message || \"\").join(\"\\n\\n\");\n            const parsed = extractJsonFromText(full);\n            if (parsed) result = {\n                parsed,\n                from: null\n            };\n        }\n        if (!result) return res.status(404).json({\n            error: \"No structured JSON found in messages\",\n            messages\n        });\n        return res.status(200).json({\n            callId: call.id,\n            output: result.parsed\n        });\n    } catch (e) {\n        console.error(e);\n        return res.status(500).json({\n            error: String(e)\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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P2I2ZTkiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQVBJX1VSTCA9IFwiaHR0cHM6Ly9hcGkuYmV5LmRldi92MVwiO1xuXG5mdW5jdGlvbiB0cnlQYXJzZUpTT04ocykge1xuICB0cnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKHMpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gZXh0cmFjdEpzb25Gcm9tVGV4dCh0ZXh0KSB7XG4gIGlmICghdGV4dCkgcmV0dXJuIG51bGw7XG4gIC8vIHRyeSBtYXJrZXJzIC8gZmVuY2VzXG4gIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgIC9PVVRQVVRfSlNPTl9TVEFSVFxccyooXFx7W1xcc1xcU10qP1xcfSlcXHMqT1VUUFVUX0pTT05fRU5ELyxcbiAgICAvYGBganNvblxccyooXFx7W1xcc1xcU10qP1xcfSlcXHMqYGBgLyxcbiAgICAvKFxce1xccypcInJvbGVcIltcXHNcXFNdKj9cXH0pLyxcbiAgXTtcbiAgZm9yIChjb25zdCBwYXQgb2YgcGF0dGVybnMpIHtcbiAgICBjb25zdCBtID0gdGV4dC5tYXRjaChwYXQpO1xuICAgIGlmIChtICYmIG1bMV0pIHtcbiAgICAgIGNvbnN0IGNhbmQgPSBtWzFdLnJlcGxhY2UoL2AvZywgXCJcIikudHJpbSgpO1xuICAgICAgY29uc3QgcGFyc2VkID0gdHJ5UGFyc2VKU09OKGNhbmQpO1xuICAgICAgaWYgKHBhcnNlZCkgcmV0dXJuIHBhcnNlZDtcbiAgICAgIC8vIHRyeSB0byByZW1vdmUgdHJhaWxpbmcgY29tbWFzIHF1aWNrbHlcbiAgICAgIGNvbnN0IGNsZWFuZWQgPSBjYW5kLnJlcGxhY2UoLyxcXHMqfVxccyokL20sIFwifVwiKS5yZXBsYWNlKC8sXFxzKlxcXVxccyokL20sIFwiXVwiKTtcbiAgICAgIGNvbnN0IHBhcnNlZDIgPSB0cnlQYXJzZUpTT04oY2xlYW5lZCk7XG4gICAgICBpZiAocGFyc2VkMikgcmV0dXJuIHBhcnNlZDI7XG4gICAgfVxuICB9XG5cbiAgLy8gZmFsbGJhY2s6IGZpbmQgYmFsYW5jZWQgey4uLn0gb3IgWy4uLl0gYmxvY2tzXG4gIGNvbnN0IG9wZW5zID0gW1sneycsJ30nXSwgWydbJywnXSddXTtcbiAgZm9yIChjb25zdCBbb3BlbiwgY2xvc2VdIG9mIG9wZW5zKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGV4dFtpXSAhPT0gb3BlbikgY29udGludWU7XG4gICAgICBsZXQgZGVwdGggPSAwO1xuICAgICAgZm9yIChsZXQgaiA9IGk7IGogPCB0ZXh0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIGlmICh0ZXh0W2pdID09PSBvcGVuKSBkZXB0aCsrO1xuICAgICAgICBlbHNlIGlmICh0ZXh0W2pdID09PSBjbG9zZSkgZGVwdGgtLTtcbiAgICAgICAgaWYgKGRlcHRoID09PSAwKSB7XG4gICAgICAgICAgY29uc3QgY2FuZCA9IHRleHQuc2xpY2UoaSwgaisxKTtcbiAgICAgICAgICBjb25zdCBwYXJzZWQgPSB0cnlQYXJzZUpTT04oY2FuZCk7XG4gICAgICAgICAgaWYgKHBhcnNlZCkgcmV0dXJuIHBhcnNlZDtcbiAgICAgICAgICBjb25zdCBjbGVhbmVkID0gY2FuZC5yZXBsYWNlKC8sXFxzKn1cXHMqJC9tLCBcIn1cIikucmVwbGFjZSgvLFxccypcXF1cXHMqJC9tLCBcIl1cIik7XG4gICAgICAgICAgY29uc3QgcGFyc2VkMiA9IHRyeVBhcnNlSlNPTihjbGVhbmVkKTtcbiAgICAgICAgICBpZiAocGFyc2VkMikgcmV0dXJuIHBhcnNlZDI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5CRVlfQVBJX0tFWTtcbiAgaWYgKCFhcGlLZXkpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnTWlzc2luZyBCRVlfQVBJX0tFWSBvbiBzZXJ2ZXInIH0pO1xuXG4gIGNvbnN0IHsgYWdlbnRJZCB9ID0gcmVxLmJvZHkgfHwge307XG4gIGlmICghYWdlbnRJZCkgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdhZ2VudElkIHJlcXVpcmVkIGluIGJvZHknIH0pO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgY2FsbHNSZXNwID0gYXdhaXQgZmV0Y2goYCR7QVBJX1VSTH0vY2FsbHNgLCB7IGhlYWRlcnM6IHsgJ3gtYXBpLWtleSc6IGFwaUtleSB9IH0pO1xuICAgIGlmICghY2FsbHNSZXNwLm9rKSB7XG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgY2FsbHNSZXNwLnRleHQoKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMikuanNvbih7IGVycm9yOiBgRmFpbGVkIGZldGNoaW5nIGNhbGxzOiAke2NhbGxzUmVzcC5zdGF0dXN9YCwgZGV0YWlsOiBib2R5IH0pO1xuICAgIH1cbiAgICBjb25zdCBjYWxsc0pzb24gPSBhd2FpdCBjYWxsc1Jlc3AuanNvbigpO1xuICAgIGNvbnN0IGNhbGxzID0gY2FsbHNKc29uLmRhdGEgfHwgW107XG4gICAgLy8gZmluZCBsYXRlc3QgZW5kZWQgY2FsbCBmb3IgdGhpcyBhZ2VudFxuICAgIGNvbnN0IGVuZGVkQ2FsbHMgPSBjYWxscy5maWx0ZXIoYyA9PiBjLmFnZW50X2lkID09PSBhZ2VudElkICYmIGMuZW5kZWRfYXQpLnNvcnQoKGEsYik9PiBuZXcgRGF0ZShiLmVuZGVkX2F0KSAtIG5ldyBEYXRlKGEuZW5kZWRfYXQpKTtcbiAgICBpZiAoZW5kZWRDYWxscy5sZW5ndGggPT09IDApIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnTm8gZW5kZWQgY2FsbHMgZm91bmQgZm9yIGFnZW50JyB9KTtcbiAgICBjb25zdCBjYWxsID0gZW5kZWRDYWxsc1swXTtcblxuICAgIGNvbnN0IG1lc3NhZ2VzUmVzcCA9IGF3YWl0IGZldGNoKGAke0FQSV9VUkx9L2NhbGxzLyR7Y2FsbC5pZH0vbWVzc2FnZXNgLCB7IGhlYWRlcnM6IHsgJ3gtYXBpLWtleSc6IGFwaUtleSB9IH0pO1xuICAgIGlmICghbWVzc2FnZXNSZXNwLm9rKSB7XG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgbWVzc2FnZXNSZXNwLnRleHQoKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMikuanNvbih7IGVycm9yOiBgRmFpbGVkIGZldGNoaW5nIG1lc3NhZ2VzOiAke21lc3NhZ2VzUmVzcC5zdGF0dXN9YCwgZGV0YWlsOiBib2R5IH0pO1xuICAgIH1cbiAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IG1lc3NhZ2VzUmVzcC5qc29uKCk7XG5cbiAgICAvLyBwcmVmZXIgYXNzaXN0YW50IG1lc3NhZ2VzIGluIHJldmVyc2VcbiAgICBsZXQgcmVzdWx0ID0gbnVsbDtcbiAgICBmb3IgKGxldCBpID0gbWVzc2FnZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IG1zZyA9IG1lc3NhZ2VzW2ldO1xuICAgICAgY29uc3Qgc2VuZGVyID0gKG1zZy5zZW5kZXIgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAoWydhc3Npc3RhbnQnLCdhaScsJ2JvdCddLmluY2x1ZGVzKHNlbmRlcikpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gZXh0cmFjdEpzb25Gcm9tVGV4dChtc2cubWVzc2FnZSB8fCAnJyk7XG4gICAgICAgIGlmIChwYXJzZWQpIHsgcmVzdWx0ID0geyBwYXJzZWQsIGZyb206IG1zZyB9OyBicmVhazsgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgY29uc3QgZnVsbCA9IG1lc3NhZ2VzLm1hcChtID0+IG0ubWVzc2FnZSB8fCAnJykuam9pbignXFxuXFxuJyk7XG4gICAgICBjb25zdCBwYXJzZWQgPSBleHRyYWN0SnNvbkZyb21UZXh0KGZ1bGwpO1xuICAgICAgaWYgKHBhcnNlZCkgcmVzdWx0ID0geyBwYXJzZWQsIGZyb206IG51bGwgfTtcbiAgICB9XG5cbiAgICBpZiAoIXJlc3VsdCkgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdObyBzdHJ1Y3R1cmVkIEpTT04gZm91bmQgaW4gbWVzc2FnZXMnLCBtZXNzYWdlcyB9KTtcblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGNhbGxJZDogY2FsbC5pZCwgb3V0cHV0OiByZXN1bHQucGFyc2VkIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcihlKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogU3RyaW5nKGUpIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQVBJX1VSTCIsInRyeVBhcnNlSlNPTiIsInMiLCJKU09OIiwicGFyc2UiLCJlIiwiZXh0cmFjdEpzb25Gcm9tVGV4dCIsInRleHQiLCJwYXR0ZXJucyIsInBhdCIsIm0iLCJtYXRjaCIsImNhbmQiLCJyZXBsYWNlIiwidHJpbSIsInBhcnNlZCIsImNsZWFuZWQiLCJwYXJzZWQyIiwib3BlbnMiLCJvcGVuIiwiY2xvc2UiLCJpIiwibGVuZ3RoIiwiZGVwdGgiLCJqIiwic2xpY2UiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkJFWV9BUElfS0VZIiwiYWdlbnRJZCIsImJvZHkiLCJjYWxsc1Jlc3AiLCJmZXRjaCIsImhlYWRlcnMiLCJvayIsImRldGFpbCIsImNhbGxzSnNvbiIsImNhbGxzIiwiZGF0YSIsImVuZGVkQ2FsbHMiLCJmaWx0ZXIiLCJjIiwiYWdlbnRfaWQiLCJlbmRlZF9hdCIsInNvcnQiLCJhIiwiYiIsIkRhdGUiLCJjYWxsIiwibWVzc2FnZXNSZXNwIiwiaWQiLCJtZXNzYWdlcyIsInJlc3VsdCIsIm1zZyIsInNlbmRlciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJtZXNzYWdlIiwiZnJvbSIsImZ1bGwiLCJtYXAiLCJqb2luIiwiY2FsbElkIiwib3V0cHV0IiwiY29uc29sZSIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/fetch-output.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffetch-output&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffetch-output.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();